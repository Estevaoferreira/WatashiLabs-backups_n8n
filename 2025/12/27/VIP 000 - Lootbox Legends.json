{"nodes":[{"parameters":{"promptType":"define","text":"=Produto: {{ $('Extrai Informa√ß√µes').item.json.productName }}\nLink de Oferta: {{ $('Extrai Informa√ß√µes').item.json.offerLink }}\nPre√ßo: {{ (() => {\n  const rawMin = $('Extrai Informa√ß√µes').item.json.priceMin;\n  const rawMax = $('Extrai Informa√ß√µes').item.json.priceMax;\n  const toNum = v => Number(String(v ?? '').replace(',', '.'));\n  const pmin = toNum(rawMin);\n  const pmax = toNum(rawMax);\n  const fmt = v => isFinite(v) ? ('R$ ' + v.toFixed(2).replace('.', ',')) : null;\n\n  if (!isFinite(pmin) && !isFinite(pmax)) return 'Indispon√≠vel';\n  if (isFinite(pmin) && isFinite(pmax)) {\n    if (Math.abs(pmax - pmin) < 0.01) return fmt(pmin);\n    const spread = (pmax - pmin) / Math.max(pmin, 0.01);\n    return spread >= 0.2 ? ('a partir de ' + fmt(pmin)) : ('de ' + fmt(pmin) + ' a ' + fmt(pmax));\n  }\n  if (isFinite(pmin)) return 'a partir de ' + fmt(pmin);\n  if (isFinite(pmax)) return 'at√© ' + fmt(pmax);\n  return 'Indispon√≠vel';\n})() }}\nAvalia√ß√£o: {{ (Number($('Extrai Informa√ß√µes').item.json.ratingStar) || 0).toFixed(1).replace('.', ',') }} ‚òÖ\n","options":{"systemMessage":"={\n  \"name\": \"AutoPromo\",\n  \"context\": {\n    \"identity\": \"Bot Vendedor da Automa√ß√£o Inteligente\",\n    \"business\": \"Sistema de Automa√ß√£o Inteligente\",\n    \"Language\": \"portugu√™s brasileiro\",\n    \"data_atual\": \"hoje √©: {{ $now.weekdayLong }}, {{ $now.format('dd/MM/yyyy') }}, hora: {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\"\n  },\n  \"Informa√ß√£o atualizada para usar em resposta\": \"{{ $json.output }}\",\n  \"personality\": [\n    \"Tom persuasivo, envolvente e natural\",\n    \"Usa emojis estrat√©gicos üéØüîßüî• para chamar aten√ß√£o sem exageros\",\n    \"Estilo formal-coloquial: pr√≥ximo e humano, sem g√≠rias excessivas\",\n    \"Enfatiza benef√≠cios, urg√™ncia e escassez para aumentar convers√£o\"\n  ],\n  \"objectives\": [\n    \"Gerar mensagens autom√°ticas curtas, criativas e visualmente organizadas para divulgar produtos da Shopee no WhatsApp\",\n    \"Criar textos que incentivem o clique imediato, transmitindo valor e urg√™ncia\"\n  ],\n  \"general_rules\": [\n    \"Resumir o nome do produto para no m√°ximo 4‚Äì6 palavras, removendo termos irrelevantes (ex.: numera√ß√£o, c√≥digos, descri√ß√µes longas)\",\n    \"Nunca incluir o link da Shopee mais de uma vez na mesma mensagem\",\n    \"N√£o repetir a mesma informa√ß√£o em blocos diferentes da mensagem\",\n    \"N√£o usar formato de link clic√°vel com texto igual ao link\",\n    \"Usar quebras de linha para criar blocos visuais claros\",\n    \"Come√ßar com t√≠tulo chamativo, pergunta de impacto ou alerta\",\n    \"Usar bullets ou marcadores ‚úîÔ∏èüîßüí° para listar vantagens\",\n    \"Transmitir urg√™ncia real (ex.: √∫ltimas unidades, v√°lido s√≥ hoje)\",\n    \"Finalizar com CTA direta e destacada: 'Clique agora', 'Garanta j√°', 'Aproveite aqui'\",\n    \"Evitar par√°grafos longos; manter leitura escane√°vel\",\n    \"Nunca coloque o pre√ßo e o link duas vezes, SEMPRE uma vez\"\n  ],\n  \"price_logic\": \"Se min==max (ou diferen√ßa < R$0,01) ‚Üí pre√ßo √∫nico. Se spread >= 20% ‚Üí 'a partir de R$ min'. Caso contr√°rio ‚Üí 'de R$ min a R$ max'. Se s√≥ min ‚Üí 'a partir de R$ min'. Se s√≥ max ‚Üí 'at√© R$ max'.\",\n  \"flow_de_atendimento_padr√£o\": {\n    \"steps\": [\n      {\n        \"1\": \"Mensagem inicial de impacto:\\nüö® *PROMO√á√ÉO REL√ÇMPAGO* üö®\\n‚ùì *J√° pensou em ter {{ $('Extrai Informa√ß√µes').item.json.productShortName }} em casa?*\\nüí• *Campe√£o de vendas na Shopee!*\"\n      },\n      {\n        \"2\": \"Lista de benef√≠cios + pre√ßo:\\n‚úîÔ∏è Benef√≠cio 1\\n‚úîÔ∏è Benef√≠cio 2\\n‚úîÔ∏è Benef√≠cio 3\\nüí° Pre√ßo: {{ (() => { const toNum = v => Number(String(v ?? '').replace(',', '.')); const pmin = toNum($('Extrai Informa√ß√µes').item.json.priceMin); const pmax = toNum($('Extrai Informa√ß√µes').item.json.priceMax); const fmt = v => isFinite(v) ? ('R$ ' + v.toFixed(2).replace('.', ',')) : null; if (!isFinite(pmin) && !isFinite(pmax)) return 'Indispon√≠vel'; if (isFinite(pmin) && isFinite(pmax)) { if (Math.abs(pmax - pmin) < 0.01) return fmt(pmin); const spread = (pmax - pmin) / Math.max(pmin, 0.01); return spread >= 0.2 ? ('a partir de ' + fmt(pmin)) : ('de ' + fmt(pmin) + ' a ' + fmt(pmax)); } if (isFinite(pmin)) return 'a partir de ' + fmt(pmin); if (isFinite(pmax)) return 'at√© ' + fmt(pmax); return 'Indispon√≠vel'; })() }}\"\n      },\n      {\n        \"3\": \"Urg√™ncia e CTA:\\nüî• *√öltimas unidades!*\\nüëâ *Garanta agora:* {{ $('Extrai Informa√ß√µes').item.json.offerLink }}\\n‚è≥ *Promo√ß√£o v√°lida s√≥ hoje!*\"\n      },\n      {\n        \"4\": \"Modelos extras para diversidade (alternar aleatoriamente)\",\n        \"modelos\": [\n          \"üî• **{{ produto_curto }}**\\nüí∞ {{ pre√ßo }}\\n‚≠ê Avalia√ß√£o: {{ avalia√ß√£o }} ‚òÖ\\nüì¶ Aproveite agora ‚Üí {{ link }}\",\n          \"‚ö†Ô∏è Restam poucas pe√ßas de **{{ produto_curto }}**!\\nüíµ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüõí Garanta o seu: {{ link }}\",\n          \"üéØ Voc√™ precisa ver isso: **{{ produto_curto }}**\\nDe: ~~pre√ßo antigo~~ | Por: {{ pre√ßo }}\\n‚≠ê Avalia√ß√£o: {{ avalia√ß√£o }}\\nüìå Clique e compre: {{ link }}\",\n          \"üèÜ Top vendas: **{{ produto_curto }}**\\nüí≤ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüí® N√£o fique sem ‚Üí {{ link }}\",\n          \"üì¢ S√≥ hoje: **{{ produto_curto }}**\\nüí∞ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüõí Garanta com desconto ‚Üí {{ link }}\"\n        ]\n      }\n    ]\n  }\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[528,432],"id":"b4a0154a-2538-44ff-b5c2-eddb1a8933a5","name":"AI Agent"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[336,528],"id":"be501006-de45-46ac-8a96-edab5994188a","name":"OpenAI Chat Model","credentials":{"openAiApi":{"id":"UCmMXFeHyX56i6WB","name":"OpenAi account"}}},{"parameters":{"resource":"messages-api","operation":"send-image","instanceName":"Estev√£o - pessoal","remoteJid":"={{ $('VIP 000 - Lootbox Legends - Numero').item.json.VIP_000_Lootbox_Legends_numero }}","media":"={{ $('Extrair imagem do link').item.json.imagem_produto }}","caption":"={{ $json.output }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1152,432],"id":"57eccf03-9064-49df-8776-882720be1937","name":"Enviar imagem","alwaysOutputData":true,"credentials":{"evolutionApi":{"id":"yNcLlaUxCcsYBcUx","name":"Pessoal"}}},{"parameters":{"amount":"={{ Math.floor(Math.random() * 5) + 40 }}"},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[928,432],"id":"e48b73b5-3787-47d5-9a05-eddbaf0a6ae8","name":"Wait","webhookId":"ecf1edd3-c449-4c00-99b9-fbe92b7b4731"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[176,416],"id":"8520ed3c-d370-4182-9428-a2977cf8ac37","name":"Loop Over Items1"},{"parameters":{"content":"","height":384,"width":1712,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-144,-144],"id":"eaf35f63-08a4-4645-ab08-d7257b8cf3b5","name":"Sticky Note"},{"parameters":{"content":"## Pega informa√ß√µes do produto tal como a imagem","height":80,"width":576,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-144,-144],"id":"ad54d6a4-297b-4d1a-9a32-5dd6b21e6916","name":"Sticky Note1"},{"parameters":{"assignments":{"assignments":[{"id":"b9ac5523-a007-4069-8263-37d73524fb2a","name":"ID Produto","value":"={{ $('Extrai Informa√ß√µes').item.json.itemId }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-80,944],"id":"a75366a0-91b7-40c3-9cab-3ab5307c7860","name":"Edit Fields"},{"parameters":{"rule":{"interval":[{"field":"minutes","minutesInterval":25}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-112,0],"id":"889bb182-d761-4e94-84cd-1979bd2c678e","name":"Schedule Trigger","disabled":true},{"parameters":{"content":"","height":432,"width":1488,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-144,272],"id":"9e00e996-8887-4045-b9ea-fead7798004a","name":"Sticky Note2"},{"parameters":{"content":"## Pega 'telefone' dos grupos, prepara mensagem e envia os produtos nos grupos","height":96,"width":672},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-144,272],"id":"583396b7-6d36-43ee-b85e-f01b036b3748","name":"Sticky Note3"},{"parameters":{"content":"","height":384,"width":560,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-144,768],"id":"5c16429b-33f3-42c5-ad98-7659220c5f31","name":"Sticky Note4"},{"parameters":{"content":"## Marca 'enviado' no produto","height":96,"width":384,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-144,768],"id":"134329fe-544d-4747-bbed-c50ef23b0cae","name":"Sticky Note5"},{"parameters":{},"type":"n8n-nodes-base.errorTrigger","typeVersion":1,"position":[544,896],"id":"454fb8bf-c150-496e-8cf1-24d0ced68071","name":"Error Trigger"},{"parameters":{"promptType":"define","text":"={{ $json.execution }}","options":{"systemMessage":"={\n  \"name\": \"LogBot\",\n  \"context\": {\n    \"identity\": \"Rob√¥ de monitoramento t√©cnico de workflows N8N\",\n    \"business\": \"Watashi Labs - Divulgador de Shopee\",\n    \"Language\": \"portugu√™s brasileiro\",\n    \"data_atual\": \"hoje √©: {{ $now.weekdayLong }}, {{ $now.format('dd/MM/yyyy') }}, hora: {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\"\n  },\n  \"Informa√ß√£o atualizada para usar em resposta\": \"{{ $json.output }}\",\n  \"personality\": [\n    \"Tom t√©cnico e direto\",\n    \"Sem emojis\",\n    \"Sem perguntas ou intera√ß√£o com usu√°rio\",\n    \"Mensagem padronizada de erro com detalhamento t√©cnico\"\n  },\n  \"objectives\": [\n    \"Identificar falhas em execu√ß√µes de workflow\",\n    \"Gerar relat√≥rio t√©cnico estruturado e fixo para desenvolvedores corrigirem problemas\"\n  ],\n  \"general_rules\": [\n    \"Sempre incluir ID da execu√ß√£o e do workflow\",\n    \"Sempre incluir URL da execu√ß√£o com link clic√°vel\",\n    \"Sempre incluir mensagem de erro\",\n    \"Sempre incluir stack trace\",\n    \"Sempre indicar o modo da execu√ß√£o\",\n    \"N√£o perguntar nada ao usu√°rio\",\n    \"N√£o tentar resolver ou interagir, apenas reportar\"\n  ],\n  \"flow_de_atendimento_padr√£o\": {\n    \"steps\": [\n      {\n        \"1\": \"Mensagem autom√°tica de erro detectado: 'üö® ERRO IDENTIFICADO NA EXECU√á√ÉO DO WORKFLOW'\"\n      },\n      {\n        \"2\": \"Relat√≥rio t√©cnico fixo:\\n\\n‚û°Ô∏è **Workflow**: {{ $json.workflow.name }} (ID: {{ $json.workflow.id }})\\n‚û°Ô∏è **Execu√ß√£o**: ID {{ $json.execution.id }}\\n‚û°Ô∏è **Modo de execu√ß√£o**: {{ $json.execution.mode }}\\n‚û°Ô∏è **Data/Hora**: {{ $now.format('dd/MM/yyyy - HH:mm') }}\\n‚û°Ô∏è **Link da execu√ß√£o**: {{ $json.execution.url }}\\n\\nüõë **Mensagem de erro**:\\n{{ $json.execution.error.message }}\\n\\nüìÑ **Stack trace**:\\n{{ $json.execution.error.stack }}\\n\\n‚úÖ A√ß√£o recomendada: revisar o workflow no editor do N8N e validar se h√° algum n√≥ com configura√ß√£o incorreta, desatualizada ou depend√™ncia ausente.\"\n      }\n    ]\n  },\n  \"tools\": []\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[752,896],"id":"615acf8b-3f51-4007-bda6-3afbfe8283c8","name":"AI Agent1"},{"parameters":{"listId":"68941895b8977bbbe1efd59d","name":"=Erro em {{ $('Error Trigger').item.json.workflow.name }} - {{ $json.execucao_id }}","description":"=# ‚ùó Erro identificado na execu√ß√£o do Workflow\n\n> üí° **Dica:**  \n> **{{ $json.recomendacao }}**\n\n---\n\n## üß© Informa√ß√µes do Workflow\n\n- **Workflow:** Divulgador de Shopee  \n- **ID do Workflow:** `{{ $json.workflow_id }}`  \n- **ID da Execu√ß√£o:** `{{ $json.execucao_id }}`  \n- **Modo de Execu√ß√£o:** `{{ $json.modo_execucao }}`  \n- **Data/Hora:** `{{ $json.data_hora }}`  \n- **üîó Link da Execu√ß√£o:**  \n  [Clique aqui para visualizar a execu√ß√£o]({{ $json.link_execucao }})\n\n---\n\n## üõë Mensagem de Erro\n\n{{ $json.mensagem_erro }}\n\n\n---\n\n## üìÑ Stack Trace\n\n{{ $json.stack_trace }}\n\n\n---\n\n## ‚úÖ Pr√≥ximos passos sugeridos\n\n- Verificar se h√° n√≥s mal configurados ou desatualizados  \n- Checar depend√™ncias e credenciais externas  \n- Testar o fluxo manualmente no editor n8n  \n","additionalFields":{}},"type":"n8n-nodes-base.trello","typeVersion":1,"position":[1312,896],"id":"1feadd29-c470-40b7-bbb3-ccd1ff725442","name":"Create a card","credentials":{"trelloApi":{"id":"OSvKEx1wr5hUtthA","name":"Estev√£o"}}},{"parameters":{"jsCode":"const texto = items[0].json.output || items[0].json?.output;\n\n// Express√µes regulares para capturar os campos\nconst workflowId = texto.match(/\\*\\*Workflow\\*\\*: .*?\\(ID: ([^)]+)\\)/)?.[1] || null;\nconst execucaoId = texto.match(/\\*\\*Execu√ß√£o\\*\\*: ID (\\d+)/)?.[1] || null;\nconst modo = texto.match(/\\*\\*Modo de execu√ß√£o\\*\\*: ([^\\n]+)/)?.[1]?.trim() || null;\nconst dataHora = texto.match(/\\*\\*Data\\/Hora\\*\\*: ([^\\n]+)/)?.[1]?.trim() || null;\n\n// Captura o link e troca 'webhook.' por 'n8n.'\nconst linkMatch = texto.match(/\\[Clique aqui\\]\\((https:\\/\\/[^\\)]+)\\)/);\nconst link = linkMatch?.[1]?.replace('webhook.', 'n8n.') || null;\n\n// Mensagem de erro e stack trace\nconst mensagemErro = texto.match(/\\*\\*Mensagem de erro\\*\\*:\\n(.+?)\\n\\n/)?.[1]?.trim() || null;\nconst stackTrace = texto.match(/\\*\\*Stack trace\\*\\*:\\n([\\s\\S]+?)\\n\\n‚úÖ/)?.[1]?.trim() || null;\n\n// A√ß√£o recomendada\nconst recomendacao = texto.match(/‚úÖ A√ß√£o recomendada: (.+)$/)?.[1]?.trim() || null;\n\n// Retorna o objeto com todos os dados extra√≠dos\nreturn [\n  {\n    json: {\n      workflow_id: workflowId,\n      execucao_id: execucaoId,\n      modo_execucao: modo,\n      data_hora: dataHora,\n      link_execucao: link,\n      mensagem_erro: mensagemErro,\n      stack_trace: stackTrace,\n      recomendacao: recomendacao,\n    }\n  }\n];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1104,896],"id":"50e2f676-2f2b-4197-90d5-4af73c6dfd4a","name":"Code"},{"parameters":{"content":"","height":416,"width":1024,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[496,768],"id":"18949e50-4f86-4ba7-9dcd-d58862d224ed","name":"Sticky Note6"},{"parameters":{"content":"## MIni fluxo de erros - card no trello","height":96,"width":384,"color":2},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[496,768],"id":"df041adc-f942-4df9-9c89-457a9ce58db3","name":"Sticky Note7"},{"parameters":{"url":"={{ $('Extrai Informa√ß√µes').item.json.imageUrl }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1200,16],"id":"45eed440-f633-4acf-ba37-3a51882fad23","name":"Pesquisa imagem"},{"parameters":{"operation":"binaryToPropery","destinationKey":"imagem_produto","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[1376,16],"id":"48fc08db-0e63-4dd4-95be-c869a3368a97","name":"Extrair imagem do link"},{"parameters":{"method":"POST","url":"=https://open-api.affiliate.shopee.com.br/graphql","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"={{ $json.authorizationHeader }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.requestBody }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[336,0],"id":"31bfc257-cbfb-49f5-bfbd-662a55168c70","name":"API Shopee"},{"parameters":{"jsCode":"const crypto = require('crypto');\n\n// --- Suas credenciais da Shopee ---\nconst appId = '18398850421';\nconst secret = 'Q24H7XRYJKETZ7FTTSCL3GL7XLKFV5VV';\n\n// --- IDs do produto que voc√™ quer consultar (usaremos para filtrar DEPOIS da requisi√ß√£o) ---\n\n\n// --- 1. Definir o Payload da Requisi√ß√£o GraphQL (SEM ARGUMENTOS DE FILTRO) ---\nconst graphqlPayloadObject = {\n  query: `\n    query GetProductOffers {\n      productOfferV2 { // <--- Chamando sem argumentos\n        nodes {\n          productName\n          itemId\n          shopId\n          commissionRate\n          commission\n          price\n          sales\n          imageUrl\n          shopName\n          productLink\n          offerLink\n          periodStartTime\n          periodEndTime\n          priceMin\n          priceMax\n          productCatIds\n          ratingStar\n          priceDiscountRate\n          shopType\n          sellerCommissionRate\n          shopeeCommissionRate\n        }\n        pageInfo {\n          page\n          limit\n          hasNextPage\n          scrollId\n        }\n      }\n    }\n  `,\n  variables: {} // Objeto de vari√°veis vazio, pois n√£o estamos passando argumentos\n};\n\n// O payload para a assinatura deve ser a string JSON exata que ser√° enviada.\nconst payloadString = JSON.stringify(graphqlPayloadObject);\n\n// --- 2. Obter o Timestamp Atual ---\nconst timestamp = Math.floor(Date.now() / 1000);\n\n// --- 3. Construir o Fator de Assinatura ---\nconst signatureFactor = `${appId}${timestamp}${payloadString}${secret}`;\n\n// --- 4. Calcular a Assinatura SHA256 ---\nconst signature = crypto.createHash('sha256').update(signatureFactor).digest('hex');\n\n// --- 5. Gerar o Cabe√ßalho de Autoriza√ß√£o ---\nconst authorizationHeader = `SHA256 Credential=${appId}, Timestamp=${timestamp}, Signature=${signature}`;\n\n// Retornar os dados necess√°rios para o pr√≥ximo n√≥ (HTTP Request)\nreturn [{\n  json: {\n    authorizationHeader: authorizationHeader,\n    requestBody: graphqlPayloadObject\n  }\n}];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[128,0],"id":"d9a57eae-1c45-4858-a3c3-247becf27d12","name":"Prepara Query para API Shopee"},{"parameters":{"jsCode":"// Pega o JSON retornado pelo node anterior\nconst input = $json;\n\n// Acesso seguro aos dados do primeiro produto\nconst product = input?.data?.productOfferV2?.nodes?.[0];\nif (!product) {\n  throw new Error('Nenhum produto encontrado na resposta.');\n}\n\n// Monta um objeto mais limpo com os campos desejados\nreturn [{\n  json: {\n    itemId: product.itemId,\n    shopId: product.shopId,\n    productName: product.productName,\n    productLink: product.productLink,\n    offerLink: product.offerLink,\n    imageUrl: product.imageUrl,\n    shopName: product.shopName,\n    priceMin: parseFloat(product.priceMin),\n    priceMax: parseFloat(product.priceMax),\n    commissionRate: parseFloat(product.commissionRate),\n    sellerCommissionRate: parseFloat(product.sellerCommissionRate),\n    shopeeCommissionRate: parseFloat(product.shopeeCommissionRate),\n    ratingStar: parseFloat(product.ratingStar),\n    sales: product.sales\n  }\n}];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[560,0],"id":"91ef5950-77bb-4e69-bec8-ad397ead2de7","name":"Extrai Informa√ß√µes"},{"parameters":{"assignments":{"assignments":[{"id":"2e2a3ebf-2538-4960-b2ae-c7d7825abe32","name":"VIP_000_Lootbox_Legends_numero","value":"120363403802905664@g.us","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-48,416],"id":"d618b081-2f7d-4cf9-8a2f-51aa320b6720","name":"VIP 000 - Lootbox Legends - Numero"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":1996874015,"mode":"list","cachedResultName":"VIP 000 - Lootbox Legends","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=1996874015"},"columns":{"mappingMode":"defineBelow","value":{"ID do produto":"={{ $json['ID Produto'] }}"},"matchingColumns":["ID do produto"],"schema":[{"id":"ID do produto","displayName":"ID do produto","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[192,944],"id":"33ce0479-1f1b-4369-b527-35637e46038d","name":"Adiciona produto na planilha","credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":1996874015,"mode":"list","cachedResultName":"VIP 000 - Lootbox Legends","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=1996874015"},"filtersUI":{"values":[{"lookupColumn":"ID do produto","lookupValue":"={{ $json.itemId }}"}]},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[768,0],"id":"d69525bc-edcd-474b-aa2a-842477bcaf7b","name":"Pesquisa produto","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"46494b7d-471c-47c3-b0dd-50f47f687053","leftValue":"={{ $json.row_number }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[976,0],"id":"1ce3a29a-7904-4596-bcea-28631855aa43","name":"se retornou algo"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[416,528],"id":"b2d96099-4515-49e1-b61f-5d46e31281ff","name":"Groq Chat Model","credentials":{"groqApi":{"id":"goykBSqf3Way2XVY","name":"Groq account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Produtos","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"Status","lookupValue":"nao_enviado"}]},"options":{"returnFirstMatch":true}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[2032,112],"id":"50ff256c-776b-4cff-b70e-e4ccd72fa325","name":"Pega produto na planilha","executeOnce":false,"credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":309245581,"mode":"list","cachedResultName":"Grupos","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=309245581"},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[1904,528],"id":"66b22215-6047-4627-b6c1-fbcd092853c7","name":"Pega 'telefone' dos grupos","credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"operation":"update","documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Produtos","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"row_number":"={{ $json.row_produto }}","Status":"enviado","Finalizado em":"=Finalizado em: {{ new Date().toLocaleString(\"pt-BR\", { timeZone: \"America/Sao_Paulo\", weekday: \"long\", day: \"2-digit\", month: \"2-digit\", year: \"numeric\", hour: \"2-digit\", minute: \"2-digit\" }) }}"},"matchingColumns":["row_number"],"schema":[{"id":"Status","displayName":"Status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Item Name","displayName":"Item Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Price","displayName":"Price","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Sales","displayName":"Sales","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Shop Name","displayName":"Shop Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Commission Rate","displayName":"Commission Rate","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Commission","displayName":"Commission","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Product Link","displayName":"Product Link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Offer Link","displayName":"Offer Link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true},{"id":"Finalizado em","displayName":"Finalizado em","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":false},{"id":"row_number","displayName":"row_number","required":false,"defaultMatch":false,"display":true,"type":"number","canBeUsedToMatch":true,"readOnly":true,"removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[2144,1056],"id":"f65bd0a7-17f4-48d4-8a6d-d0607a86f8d1","name":"Pega produto na planilha1","credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"content":"","height":1552,"width":1808,"color":2},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1760,-160],"id":"77ec6fa3-edf3-4e86-b857-4bf54b5b9fb7","name":"Sticky Note8"},{"parameters":{"content":"# Shopee","height":80,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1760,-160],"id":"8d076969-b354-4afe-899e-9dabc0d7cdaf","name":"Sticky Note9"},{"parameters":{"rule":{"interval":[{"triggerAtHour":8}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[2048,-144],"id":"bccec9f9-03f9-485f-8239-1dc59e76ad19","name":"Schedule Trigger3","disabled":true},{"parameters":{"rule":{"interval":[{"triggerAtHour":16}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[2512,-144],"id":"7b2d48f3-0893-4d11-a7e2-1ec0d9c80588","name":"Schedule Trigger4","disabled":true},{"parameters":{"promptType":"define","text":"=Produto: {{ $('Extrai Informa√ß√µes1').item.json.productName }}\nLink de Oferta: {{ $('Extrai Informa√ß√µes1').item.json.offerLink }}\nPre√ßo: {{ (() => {\n  const rawMin = $('Extrai Informa√ß√µes1').item.json.priceMin;\n  const rawMax = $('Extrai Informa√ß√µes1').item.json.priceMax;\n  const toNum = v => Number(String(v ?? '').replace(',', '.'));\n  const pmin = toNum(rawMin);\n  const pmax = toNum(rawMax);\n  const fmt = v => isFinite(v) ? ('R$ ' + v.toFixed(2).replace('.', ',')) : null;\n\n  if (!isFinite(pmin) && !isFinite(pmax)) return 'Indispon√≠vel';\n  if (isFinite(pmin) && isFinite(pmax)) {\n    if (Math.abs(pmax - pmin) < 0.01) return fmt(pmin);\n    const spread = (pmax - pmin) / Math.max(pmin, 0.01);\n    return spread >= 0.2 ? ('a partir de ' + fmt(pmin)) : ('de ' + fmt(pmin) + ' a ' + fmt(pmax));\n  }\n  if (isFinite(pmin)) return 'a partir de ' + fmt(pmin);\n  if (isFinite(pmax)) return 'at√© ' + fmt(pmax);\n  return 'Indispon√≠vel';\n})() }}\nAvalia√ß√£o: {{ (Number($('Extrai Informa√ß√µes1').item.json.ratingStar) || 0).toFixed(1).replace('.', ',') }} ‚òÖ\n","options":{"systemMessage":"={\n  \"name\": \"AutoPromo\",\n  \"context\": {\n    \"identity\": \"Bot Vendedor da Automa√ß√£o Inteligente\",\n    \"business\": \"Sistema de Automa√ß√£o Inteligente\",\n    \"Language\": \"portugu√™s brasileiro\",\n    \"data_atual\": \"hoje √©: {{ $now.weekdayLong }}, {{ $now.format('dd/MM/yyyy') }}, hora: {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\"\n  },\n  \"Informa√ß√£o atualizada para usar em resposta\": \"{{ $json.output }}\",\n  \"personality\": [\n    \"Tom persuasivo, envolvente e natural\",\n    \"Usa emojis estrat√©gicos üéØüîßüî• para chamar aten√ß√£o sem exageros\",\n    \"Estilo formal-coloquial: pr√≥ximo e humano, sem g√≠rias excessivas\",\n    \"Enfatiza benef√≠cios, urg√™ncia e escassez para aumentar convers√£o\"\n  ],\n  \"objectives\": [\n    \"Gerar mensagens autom√°ticas curtas, criativas e visualmente organizadas para divulgar produtos da Shopee no WhatsApp\",\n    \"Criar textos que incentivem o clique imediato, transmitindo valor e urg√™ncia\"\n  ],\n  \"general_rules\": [\n    \"Resumir o nome do produto para no m√°ximo 4‚Äì6 palavras, removendo termos irrelevantes (ex.: numera√ß√£o, c√≥digos, descri√ß√µes longas)\",\n    \"Nunca incluir o link da Shopee mais de uma vez na mesma mensagem\",\n    \"N√£o repetir a mesma informa√ß√£o em blocos diferentes da mensagem\",\n    \"N√£o usar formato de link clic√°vel com texto igual ao link\",\n    \"Usar quebras de linha para criar blocos visuais claros\",\n    \"Come√ßar com t√≠tulo chamativo, pergunta de impacto ou alerta\",\n    \"Usar bullets ou marcadores ‚úîÔ∏èüîßüí° para listar vantagens\",\n    \"Transmitir urg√™ncia real (ex.: √∫ltimas unidades, v√°lido s√≥ hoje)\",\n    \"Finalizar com CTA direta e destacada: 'Clique agora', 'Garanta j√°', 'Aproveite aqui'\",\n    \"Evitar par√°grafos longos; manter leitura escane√°vel\",\n    \"Nunca coloque o pre√ßo e o link duas vezes, SEMPRE uma vez\"\n  ],\n  \"price_logic\": \"Se min==max (ou diferen√ßa < R$0,01) ‚Üí pre√ßo √∫nico. Se spread >= 20% ‚Üí 'a partir de R$ min'. Caso contr√°rio ‚Üí 'de R$ min a R$ max'. Se s√≥ min ‚Üí 'a partir de R$ min'. Se s√≥ max ‚Üí 'at√© R$ max'.\",\n  \"flow_de_atendimento_padr√£o\": {\n    \"steps\": [\n      {\n        \"1\": \"Mensagem inicial de impacto:\\nüö® *PROMO√á√ÉO REL√ÇMPAGO* üö®\\n‚ùì *J√° pensou em ter {{ $('Extrai Informa√ß√µes1').item.json.productName }} em casa?*\\nüí• *Campe√£o de vendas na Shopee!*\"\n      },\n      {\n        \"2\": \"Lista de benef√≠cios + pre√ßo:\\n‚úîÔ∏è Benef√≠cio 1\\n‚úîÔ∏è Benef√≠cio 2\\n‚úîÔ∏è Benef√≠cio 3\\nüí° Pre√ßo: {{ (() => { const toNum = v => Number(String(v ?? '').replace(',', '.')); const pmin = toNum($('Extrai Informa√ß√µes1').item.json.priceMin); const pmax = toNum($('Extrai Informa√ß√µes1').item.json.priceMax); const fmt = v => isFinite(v) ? ('R$ ' + v.toFixed(2).replace('.', ',')) : null; if (!isFinite(pmin) && !isFinite(pmax)) return 'Indispon√≠vel'; if (isFinite(pmin) && isFinite(pmax)) { if (Math.abs(pmax - pmin) < 0.01) return fmt(pmin); const spread = (pmax - pmin) / Math.max(pmin, 0.01); return spread >= 0.2 ? ('a partir de ' + fmt(pmin)) : ('de ' + fmt(pmin) + ' a ' + fmt(pmax)); } if (isFinite(pmin)) return 'a partir de ' + fmt(pmin); if (isFinite(pmax)) return 'at√© ' + fmt(pmax); return 'Indispon√≠vel'; })() }}\"\n      },\n      {\n        \"3\": \"Urg√™ncia e CTA:\\nüî• *√öltimas unidades!*\\nüëâ *Garanta agora:* {{ $('Extrai Informa√ß√µes1').item.json.offerLink }}\\n‚è≥ *Promo√ß√£o v√°lida s√≥ hoje!*\"\n      },\n      {\n        \"4\": \"Modelos extras para diversidade (alternar aleatoriamente)\",\n        \"modelos\": [\n          \"üî• **{{ produto_curto }}**\\nüí∞ {{ pre√ßo }}\\n‚≠ê Avalia√ß√£o: {{ avalia√ß√£o }} ‚òÖ\\nüì¶ Aproveite agora ‚Üí {{ link }}\",\n          \"‚ö†Ô∏è Restam poucas pe√ßas de **{{ produto_curto }}**!\\nüíµ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüõí Garanta o seu: {{ link }}\",\n          \"üéØ Voc√™ precisa ver isso: **{{ produto_curto }}**\\nDe: ~~pre√ßo antigo~~ | Por: {{ pre√ßo }}\\n‚≠ê Avalia√ß√£o: {{ avalia√ß√£o }}\\nüìå Clique e compre: {{ link }}\",\n          \"üèÜ Top vendas: **{{ produto_curto }}**\\nüí≤ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüí® N√£o fique sem ‚Üí {{ link }}\",\n          \"üì¢ S√≥ hoje: **{{ produto_curto }}**\\nüí∞ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüõí Garanta com desconto ‚Üí {{ link }}\"\n        ]\n      }\n    ]\n  }\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[2480,544],"id":"82f81aab-d66f-465b-9000-7c7f259b838c","name":"AI Agent2"},{"parameters":{"resource":"messages-api","operation":"send-image","instanceName":"Estev√£o - pessoal","remoteJid":"={{ $('Pega \\'telefone\\' dos grupos').item.json['N√∫mero do grupo'] }}","media":"={{ $('Extrair imagem do link1').item.json.imagem_produto }}","caption":"={{ $json.output }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[3088,544],"id":"b1eae19b-1d7a-4f6e-b3d2-15f713c2f30f","name":"Enviar imagem1","alwaysOutputData":true,"credentials":{"evolutionApi":{"id":"yNcLlaUxCcsYBcUx","name":"Pessoal"}}},{"parameters":{"amount":"={{ Math.floor(Math.random() * 5) + 40 }}"},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[2880,544],"id":"1a59502b-72d7-427d-b055-1b0e151a4a43","name":"Wait1","webhookId":"1717c0cb-3a74-4962-a2a6-0645684ae23a"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[2128,528],"id":"4d4a2dab-d494-4e0f-8567-e69e85cae9b0","name":"Loop Over Items"},{"parameters":{"content":"","height":352,"width":1344,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1808,-32],"id":"6c42f358-738d-42b8-8c8e-e47ab25d31d3","name":"Sticky Note10"},{"parameters":{"content":"## Pega informa√ß√µes do produto tal como a imagem","height":80,"width":576,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1808,-32],"id":"4e77289f-6546-4c4a-8ba6-5a790560eba6","name":"Sticky Note11"},{"parameters":{"assignments":{"assignments":[{"id":"b9ac5523-a007-4069-8263-37d73524fb2a","name":"row_produto","value":"={{ $('Pega produto na planilha').item.json.row_number }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[1872,1056],"id":"a1f8fa6b-dad1-4a59-b68c-d0a813e33068","name":"Edit Fields1"},{"parameters":{"content":"","height":432,"width":1488,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1808,384],"id":"657c849b-6a74-44ab-8022-8085f03cc0cf","name":"Sticky Note12"},{"parameters":{"content":"## Pega 'telefone' dos grupos, prepara mensagem e envia os produtos nos grupos","height":96,"width":672,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1808,384],"id":"dc63ffba-1a0a-4adc-bf0d-5789b0d12c03","name":"Sticky Note13"},{"parameters":{"content":"","height":384,"width":608,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1808,880],"id":"1a281e10-715d-47d2-b42a-74bd20178bbe","name":"Sticky Note14"},{"parameters":{"content":"## Marca 'enviado' no produto","height":96,"width":384,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[1808,880],"id":"8a59e882-a1de-4568-ad31-37c6ac86c7ee","name":"Sticky Note15"},{"parameters":{"promptType":"define","text":"={{ $json.execution }}","options":{"systemMessage":"={\n  \"name\": \"LogBot\",\n  \"context\": {\n    \"identity\": \"Rob√¥ de monitoramento t√©cnico de workflows N8N\",\n    \"business\": \"Watashi Labs - Divulgador de Shopee\",\n    \"Language\": \"portugu√™s brasileiro\",\n    \"data_atual\": \"hoje √©: {{ $now.weekdayLong }}, {{ $now.format('dd/MM/yyyy') }}, hora: {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\"\n  },\n  \"Informa√ß√£o atualizada para usar em resposta\": \"{{ $json.output }}\",\n  \"personality\": [\n    \"Tom t√©cnico e direto\",\n    \"Sem emojis\",\n    \"Sem perguntas ou intera√ß√£o com usu√°rio\",\n    \"Mensagem padronizada de erro com detalhamento t√©cnico\"\n  },\n  \"objectives\": [\n    \"Identificar falhas em execu√ß√µes de workflow\",\n    \"Gerar relat√≥rio t√©cnico estruturado e fixo para desenvolvedores corrigirem problemas\"\n  ],\n  \"general_rules\": [\n    \"Sempre incluir ID da execu√ß√£o e do workflow\",\n    \"Sempre incluir URL da execu√ß√£o com link clic√°vel\",\n    \"Sempre incluir mensagem de erro\",\n    \"Sempre incluir stack trace\",\n    \"Sempre indicar o modo da execu√ß√£o\",\n    \"N√£o perguntar nada ao usu√°rio\",\n    \"N√£o tentar resolver ou interagir, apenas reportar\"\n  ],\n  \"flow_de_atendimento_padr√£o\": {\n    \"steps\": [\n      {\n        \"1\": \"Mensagem autom√°tica de erro detectado: 'üö® ERRO IDENTIFICADO NA EXECU√á√ÉO DO WORKFLOW'\"\n      },\n      {\n        \"2\": \"Relat√≥rio t√©cnico fixo:\\n\\n‚û°Ô∏è **Workflow**: {{ $json.workflow.name }} (ID: {{ $json.workflow.id }})\\n‚û°Ô∏è **Execu√ß√£o**: ID {{ $json.execution.id }}\\n‚û°Ô∏è **Modo de execu√ß√£o**: {{ $json.execution.mode }}\\n‚û°Ô∏è **Data/Hora**: {{ $now.format('dd/MM/yyyy - HH:mm') }}\\n‚û°Ô∏è **Link da execu√ß√£o**: {{ $json.execution.url }}\\n\\nüõë **Mensagem de erro**:\\n{{ $json.execution.error.message }}\\n\\nüìÑ **Stack trace**:\\n{{ $json.execution.error.stack }}\\n\\n‚úÖ A√ß√£o recomendada: revisar o workflow no editor do N8N e validar se h√° algum n√≥ com configura√ß√£o incorreta, desatualizada ou depend√™ncia ausente.\"\n      }\n    ]\n  },\n  \"tools\": []\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[2704,1008],"id":"ad8aea47-7c90-4de7-9970-9170ad5ebe26","name":"AI Agent3"},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[2496,1088],"id":"cf7896f0-31af-4d94-aef1-cfe8579a206f","name":"OpenAI Chat Model3","credentials":{"openAiApi":{"id":"UCmMXFeHyX56i6WB","name":"OpenAi account"}}},{"parameters":{"listId":"68941895b8977bbbe1efd59d","name":"=Erro em {{ $('Error Trigger').item.json.workflow.name }} - {{ $json.execucao_id }}","description":"=# ‚ùó Erro identificado na execu√ß√£o do Workflow\n\n> üí° **Dica:**  \n> **{{ $json.recomendacao }}**\n\n---\n\n## üß© Informa√ß√µes do Workflow\n\n- **Workflow:** Divulgador de Shopee  \n- **ID do Workflow:** `{{ $json.workflow_id }}`  \n- **ID da Execu√ß√£o:** `{{ $json.execucao_id }}`  \n- **Modo de Execu√ß√£o:** `{{ $json.modo_execucao }}`  \n- **Data/Hora:** `{{ $json.data_hora }}`  \n- **üîó Link da Execu√ß√£o:**  \n  [Clique aqui para visualizar a execu√ß√£o]({{ $json.link_execucao }})\n\n---\n\n## üõë Mensagem de Erro\n\n{{ $json.mensagem_erro }}\n\n\n---\n\n## üìÑ Stack Trace\n\n{{ $json.stack_trace }}\n\n\n---\n\n## ‚úÖ Pr√≥ximos passos sugeridos\n\n- Verificar se h√° n√≥s mal configurados ou desatualizados  \n- Checar depend√™ncias e credenciais externas  \n- Testar o fluxo manualmente no editor n8n  \n","additionalFields":{}},"type":"n8n-nodes-base.trello","typeVersion":1,"position":[3264,1008],"id":"b8fef3d3-556d-4241-a293-d6d74b95540b","name":"Create a card1","credentials":{"trelloApi":{"id":"OSvKEx1wr5hUtthA","name":"Estev√£o"}}},{"parameters":{"jsCode":"const texto = items[0].json.output || items[0].json?.output;\n\n// Express√µes regulares para capturar os campos\nconst workflowId = texto.match(/\\*\\*Workflow\\*\\*: .*?\\(ID: ([^)]+)\\)/)?.[1] || null;\nconst execucaoId = texto.match(/\\*\\*Execu√ß√£o\\*\\*: ID (\\d+)/)?.[1] || null;\nconst modo = texto.match(/\\*\\*Modo de execu√ß√£o\\*\\*: ([^\\n]+)/)?.[1]?.trim() || null;\nconst dataHora = texto.match(/\\*\\*Data\\/Hora\\*\\*: ([^\\n]+)/)?.[1]?.trim() || null;\n\n// Captura o link e troca 'webhook.' por 'n8n.'\nconst linkMatch = texto.match(/\\[Clique aqui\\]\\((https:\\/\\/[^\\)]+)\\)/);\nconst link = linkMatch?.[1]?.replace('webhook.', 'n8n.') || null;\n\n// Mensagem de erro e stack trace\nconst mensagemErro = texto.match(/\\*\\*Mensagem de erro\\*\\*:\\n(.+?)\\n\\n/)?.[1]?.trim() || null;\nconst stackTrace = texto.match(/\\*\\*Stack trace\\*\\*:\\n([\\s\\S]+?)\\n\\n‚úÖ/)?.[1]?.trim() || null;\n\n// A√ß√£o recomendada\nconst recomendacao = texto.match(/‚úÖ A√ß√£o recomendada: (.+)$/)?.[1]?.trim() || null;\n\n// Retorna o objeto com todos os dados extra√≠dos\nreturn [\n  {\n    json: {\n      workflow_id: workflowId,\n      execucao_id: execucaoId,\n      modo_execucao: modo,\n      data_hora: dataHora,\n      link_execucao: link,\n      mensagem_erro: mensagemErro,\n      stack_trace: stackTrace,\n      recomendacao: recomendacao,\n    }\n  }\n];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3056,1008],"id":"2448f17b-1cf1-425e-aa40-3d9cb036e31a","name":"Code1"},{"parameters":{"content":"","height":416,"width":1056,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2448,880],"id":"931e5a8f-80d5-4f6e-ac0d-78e030a5d822","name":"Sticky Note16"},{"parameters":{"content":"## MIni fluxo de erros - card no trello","height":96,"width":384,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[2448,880],"id":"fe2df6bc-61ff-4c96-9120-fe2747b5e790","name":"Sticky Note17"},{"parameters":{"url":"={{ $json.imageUrl }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2736,112],"id":"ee1e792b-86f9-49a7-9f35-9d5d99caac5a","name":"Pesquisa imagem1"},{"parameters":{"operation":"binaryToPropery","destinationKey":"imagem_produto","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[2912,112],"id":"cf945041-44ab-41f1-80bf-e2a49f08048a","name":"Extrair imagem do link1"},{"parameters":{"method":"POST","url":"=https://open-api.affiliate.shopee.com.br/graphql","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"={{ $json.authorizationHeader }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.requestBody }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[2384,112],"id":"f5c0ebdb-afa1-4212-a447-6ff435be37df","name":"API Shopee1"},{"parameters":{"jsCode":"const crypto = require('crypto');\n\nconst appId = '18398850421';\nconst secret = 'Q24H7XRYJKETZ7FTTSCL3GL7XLKFV5VV';\n\n// Pega link do produto do node \"Pega produto na planilha\"\nconst url = $('Pega produto na planilha').first().json['Product Link'];\nif (!url) throw new Error('Nenhum link encontrado no campo \"Product Link\".');\n\n// Extrai shopId/itemId de /product/{shopId}/{itemId} ou -i.{shopId}.{itemId}\nlet shopId, itemId;\nlet m = url.match(/\\/product\\/(\\d+)\\/(\\d+)/);\nif (m) { \n  shopId = m[1]; \n  itemId = m[2]; \n} else {\n  m = url.match(/-i\\.(\\d+)\\.(\\d+)/);\n  if (m) { \n    shopId = m[1]; \n    itemId = m[2]; \n  }\n}\nif (!itemId) throw new Error('N√£o foi poss√≠vel extrair itemId/shopId do link.');\n\n// Monta query GraphQL com literais\nconst rawQuery = `\n  query {\n    productOfferV2(itemId: ${itemId}, shopId: ${shopId || 'null'}, page: 1, limit: 1) {\n      nodes {\n        itemId shopId productName productLink offerLink imageUrl shopName\n        priceMin priceMax commissionRate sellerCommissionRate shopeeCommissionRate\n        ratingStar sales\n      }\n      pageInfo { page limit hasNextPage }\n    }\n  }\n`;\n\n// Minifica\nlet q = rawQuery\n  .replace(/\\/\\/.*$/gm, '')\n  .replace(/\\/\\*[\\s\\S]*?\\*\\//g, '')\n  .replace(/[\\n\\r]/g, ' ')\n  .replace(/\\s+/g, ' ')\n  .replace(/\\s*([(){}:,])\\s*/g, '$1')\n  .trim();\n\nconst graphqlPayloadObject = { query: q };\nconst payloadString = JSON.stringify(graphqlPayloadObject);\n\nconst timestamp = Math.floor(Date.now() / 1000);\nconst signatureFactor = `${appId}${timestamp}${payloadString}${secret}`;\nconst signature = crypto.createHash('sha256').update(signatureFactor).digest('hex');\nconst authorizationHeader = `SHA256 Credential=${appId}, Timestamp=${timestamp}, Signature=${signature}`;\n\nreturn [{\n  json: {\n    url, itemId, shopId,\n    authorizationHeader,\n    requestBody: graphqlPayloadObject\n  }\n}];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2192,112],"id":"e235a156-2aa3-4e4f-8911-512a60f33d81","name":"Prepara Query para API Shopee1"},{"parameters":{"jsCode":"// Pega o JSON retornado pelo node anterior\nconst input = $json;\n\n// Acesso seguro aos dados do primeiro produto\nconst product = input?.data?.productOfferV2?.nodes?.[0];\nif (!product) {\n  throw new Error('Nenhum produto encontrado na resposta.');\n}\n\n// Monta um objeto mais limpo com os campos desejados\nreturn [{\n  json: {\n    itemId: product.itemId,\n    shopId: product.shopId,\n    productName: product.productName,\n    productLink: product.productLink,\n    offerLink: product.offerLink,\n    imageUrl: product.imageUrl,\n    shopName: product.shopName,\n    priceMin: parseFloat(product.priceMin),\n    priceMax: parseFloat(product.priceMax),\n    commissionRate: parseFloat(product.commissionRate),\n    sellerCommissionRate: parseFloat(product.sellerCommissionRate),\n    shopeeCommissionRate: parseFloat(product.shopeeCommissionRate),\n    ratingStar: parseFloat(product.ratingStar),\n    sales: product.sales\n  }\n}];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[2560,112],"id":"5144b62a-ddbb-4b79-8009-553476deb2d0","name":"Extrai Informa√ß√µes1"},{"parameters":{"rule":{"interval":[{"triggerAtHour":12}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[2256,-144],"id":"63073819-5c86-423e-a377-21367aa5d117","name":"Schedule Trigger1","disabled":true},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[2384,640],"id":"0eee0554-6698-4d64-8b2f-4a3eada93fc4","name":"Groq Chat Model1","credentials":{"groqApi":{"id":"goykBSqf3Way2XVY","name":"Groq account"}}},{"parameters":{"model":{"__rl":true,"value":"gpt-4o","mode":"list","cachedResultName":"gpt-4o"},"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatOpenAi","typeVersion":1.2,"position":[608,1040],"id":"07f9383c-c7e2-4bf1-b05e-1183040bc139","name":"OpenAI Chat Model1","credentials":{"openAiApi":{"id":"UCmMXFeHyX56i6WB","name":"OpenAi account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[752,1072],"id":"30c04063-fd0b-4309-9341-92d5ecbdf1c3","name":"Groq Chat Model2","credentials":{"groqApi":{"id":"goykBSqf3Way2XVY","name":"Groq account"}}},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[2704,1168],"id":"cb383906-dfee-4ef5-adf3-93e0d407acdd","name":"Groq Chat Model3","credentials":{"groqApi":{"id":"goykBSqf3Way2XVY","name":"Groq account"}}},{"parameters":{"promptType":"define","text":"=Produto: {{ $('Extrai Informa√ß√µes2').item.json.nome }}\nLink de Oferta: {{ $('Extrai Informa√ß√µes2').item.json.linkAfiliado }}\nPre√ßo: {{ $('Extrai Informa√ß√µes2').item.json.faixaPrecoFormatada }}\nAvalia√ß√£o: {{ $('Extrai Informa√ß√µes2').item.json.avaliacao }} ‚òÖ\n\n\n\n","options":{"systemMessage":"={\n  \"name\": \"AutoPromo\",\n  \"context\": {\n    \"identity\": \"Bot Vendedor da Automa√ß√£o Inteligente\",\n    \"business\": \"Sistema de Automa√ß√£o Inteligente\",\n    \"Language\": \"portugu√™s brasileiro\",\n    \"data_atual\": \"hoje √©: {{ $now.weekdayLong }}, {{ $now.format('dd/MM/yyyy') }}, hora: {{ $now.hour.toString().padStart(2, '0') }}:{{ $now.minute.toString().padStart(2, '0') }}\"\n  },\n  \"Informa√ß√£o atualizada para usar em resposta\": \"{{ $json.output }}\",\n  \"personality\": [\n    \"Tom persuasivo, envolvente e natural\",\n    \"Usa emojis estrat√©gicos üéØüîßüî• para chamar aten√ß√£o sem exageros\",\n    \"Estilo formal-coloquial: pr√≥ximo e humano, sem g√≠rias excessivas\",\n    \"Enfatiza benef√≠cios, urg√™ncia e escassez para aumentar convers√£o\"\n  ],\n  \"objectives\": [\n    \"Gerar mensagens autom√°ticas curtas, criativas e visualmente organizadas para divulgar produtos da Shopee no WhatsApp\",\n    \"Criar textos que incentivem o clique imediato, transmitindo valor e urg√™ncia\"\n  ],\n  \"general_rules\": [\n    \"Resumir o nome do produto para no m√°ximo 4‚Äì6 palavras, removendo termos irrelevantes (ex.: numera√ß√£o, c√≥digos, descri√ß√µes longas)\",\n    \"Nunca incluir o link da Shopee mais de uma vez na mesma mensagem\",\n    \"N√£o repetir a mesma informa√ß√£o em blocos diferentes da mensagem\",\n    \"N√£o usar formato de link clic√°vel com texto igual ao link\",\n    \"Usar quebras de linha para criar blocos visuais claros\",\n    \"Come√ßar com t√≠tulo chamativo, pergunta de impacto ou alerta\",\n    \"Usar bullets ou marcadores ‚úîÔ∏èüîßüí° para listar vantagens\",\n    \"Transmitir urg√™ncia real (ex.: √∫ltimas unidades, v√°lido s√≥ hoje)\",\n    \"Finalizar com CTA direta e destacada: 'Clique agora', 'Garanta j√°', 'Aproveite aqui'\",\n    \"Evitar par√°grafos longos; manter leitura escane√°vel\",\n    \"Nunca coloque o pre√ßo e o link duas vezes, SEMPRE uma vez\"\n  ],\n  \"price_logic\": \"Se min==max (ou diferen√ßa < R$0,01) ‚Üí pre√ßo √∫nico. Se spread >= 20% ‚Üí 'a partir de R$ min'. Caso contr√°rio ‚Üí 'de R$ min a R$ max'. Se s√≥ min ‚Üí 'a partir de R$ min'. Se s√≥ max ‚Üí 'at√© R$ max'.\",\n  \"flow_de_atendimento_padr√£o\": {\n    \"steps\": [\n      {\n        \"1\": \"Mensagem inicial de impacto:\\nüö® *PROMO√á√ÉO REL√ÇMPAGO* üö®\\n‚ùì *J√° pensou em ter {{ $('Extrai Informa√ß√µes2').item.json.nome }} em casa?*\\nüí• *Campe√£o de vendas na Shopee!*\"\n      },\n      {\n        \"2\": \"Lista de benef√≠cios + pre√ßo:\\n‚úîÔ∏è Benef√≠cio 1\\n‚úîÔ∏è Benef√≠cio 2\\n‚úîÔ∏è Benef√≠cio 3\\nüí° Pre√ßo: {{ $('Extrai Informa√ß√µes2').item.json.faixaPrecoFormatada }}\"\n      },\n      {\n        \"3\": \"Urg√™ncia e CTA:\\nüî• *√öltimas unidades!*\\nüëâ *Garanta agora:* {{ $('Extrai Informa√ß√µes2').item.json.linkAfiliado }}\\n‚è≥ *Promo√ß√£o v√°lida s√≥ hoje!*\"\n      },\n      {\n        \"4\": \"Modelos extras para diversidade (alternar aleatoriamente)\",\n        \"modelos\": [\n          \"üî• **{{ produto_curto }}**\\nüí∞ {{ pre√ßo }}\\n‚≠ê Avalia√ß√£o: {{ avalia√ß√£o }} ‚òÖ\\nüì¶ Aproveite agora ‚Üí {{ link }}\",\n          \"‚ö†Ô∏è Restam poucas pe√ßas de **{{ produto_curto }}**!\\nüíµ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüõí Garanta o seu: {{ link }}\",\n          \"üéØ Voc√™ precisa ver isso: **{{ produto_curto }}**\\nDe: ~~pre√ßo antigo~~ | Por: {{ pre√ßo }}\\n‚≠ê Avalia√ß√£o: {{ avalia√ß√£o }}\\nüìå Clique e compre: {{ link }}\",\n          \"üèÜ Top vendas: **{{ produto_curto }}**\\nüí≤ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüí® N√£o fique sem ‚Üí {{ link }}\",\n          \"üì¢ S√≥ hoje: **{{ produto_curto }}**\\nüí∞ {{ pre√ßo }} | ‚≠ê {{ avalia√ß√£o }}\\nüõí Garanta com desconto ‚Üí {{ link }}\"\n        ]\n      }\n    ]\n  }\n}\n"}},"type":"@n8n/n8n-nodes-langchain.agent","typeVersion":2.1,"position":[688,2144],"id":"e21520a8-bc8e-41d2-942b-f1736d87a5bb","name":"AI Agent4"},{"parameters":{"resource":"messages-api","operation":"send-image","instanceName":"Estev√£o - pessoal","remoteJid":"={{ $('VIP 000 - Lootbox Legends - Numero1').item.json.VIP_000_Lootbox_Legends_numero }}","media":"={{ $('Extrair imagem do link2').item.json.imagem_produto }}","caption":"={{ $json.output }}","options_message":{}},"type":"n8n-nodes-evolution-api.evolutionApi","typeVersion":1,"position":[1312,2144],"id":"cc345ccc-0f0d-4dbc-9d46-84c4900ce510","name":"Enviar imagem2","alwaysOutputData":true,"credentials":{"evolutionApi":{"id":"yNcLlaUxCcsYBcUx","name":"Pessoal"}}},{"parameters":{"amount":"={{ Math.floor(Math.random() * 5) + 40 }}"},"type":"n8n-nodes-base.wait","typeVersion":1.1,"position":[1088,2144],"id":"cd94b764-7488-4c81-8648-517b333e0a0e","name":"Wait2","webhookId":"ecf1edd3-c449-4c00-99b9-fbe92b7b4731"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[128,2128],"id":"59ffd325-efd0-4a9e-abd3-f8ca6b6d843c","name":"Loop Over Items2"},{"parameters":{"content":"","height":384,"width":2304,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-176,1504],"id":"14f28fad-db52-4a05-b73f-55f94165b93c","name":"Sticky Note18"},{"parameters":{"content":"## Pega informa√ß√µes do produto tal como a imagem","height":80,"width":576,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-176,1504],"id":"67438b21-e59a-4c5e-92fe-a90153ac4270","name":"Sticky Note19"},{"parameters":{"assignments":{"assignments":[{"id":"b9ac5523-a007-4069-8263-37d73524fb2a","name":"ID Produto","value":"={{ $('Extrai Informa√ß√µes2').item.json.id }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-96,2640],"id":"cbaab2c6-deff-4158-8996-6104d2f84283","name":"Edit Fields2"},{"parameters":{"rule":{"interval":[{"field":"cronExpression","expression":"0 0,15,30,45 * * * *"}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[-112,1632],"id":"04b3d220-b454-41aa-9c47-0a6467c66db7","name":"Schedule Trigger2"},{"parameters":{"content":"","height":432,"width":1904,"color":4},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-176,1984],"id":"c55aa7ec-7d9f-4a70-8f1e-d4046328aec0","name":"Sticky Note20"},{"parameters":{"content":"## Pega 'telefone' dos grupos, prepara mensagem e envia os produtos nos grupos","height":96,"width":672},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-176,1984],"id":"e3b2194b-4746-4676-98d3-b68cf3b2caf8","name":"Sticky Note21"},{"parameters":{"content":"","height":384,"width":560,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-160,2464],"id":"4a608787-34e7-4343-9854-0308bd457ca2","name":"Sticky Note22"},{"parameters":{"content":"## Marca 'enviado' no produto","height":96,"width":384,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[-160,2464],"id":"c8ea04c1-ff18-4842-a6df-62ac2b8e48eb","name":"Sticky Note23"},{"parameters":{"url":"={{ $('Extrai Informa√ß√µes2').item.json.imagem }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[1728,1648],"id":"5e78d4ed-a610-425c-8fbd-fe2db11c349c","name":"Pesquisa imagem2"},{"parameters":{"operation":"binaryToPropery","destinationKey":"imagem_produto","options":{}},"type":"n8n-nodes-base.extractFromFile","typeVersion":1,"position":[1904,1648],"id":"64f62a43-bea6-4318-ab18-1adcba4d2278","name":"Extrair imagem do link2"},{"parameters":{"method":"POST","url":"=https://open-api.affiliate.shopee.com.br/graphql","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"={{ $json.authorizationHeader }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.requestBody }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[576,1632],"id":"eba58237-85f2-4801-85dd-9d21d6a4071f","name":"API Shopee2"},{"parameters":{"jsCode":"const crypto = require('crypto');\n\n// --- Suas credenciais Shopee ---\nconst appId = '18398850421';\nconst secret = 'Q24H7XRYJKETZ7FTTSCL3GL7XLKFV5VV';\n\n// --- Pega a keyword de um node anterior ---\nconst keyword = $json.keyword || \"maternidade\"; // fallback pra n√£o quebrar se n√£o vier nada\n\n// --- Payload da query ---\nconst graphqlPayloadObject = {\n  query: `\n    query GetProductOffers {\n      productOfferV2(\n        keyword: \"${keyword}\"\n        page: 1\n        limit: 50\n      ) {\n        nodes {\n          productName\n          itemId\n          shopId\n          commissionRate\n          commission\n          price\n          sales\n          imageUrl\n          shopName\n          productLink\n          offerLink\n          periodStartTime\n          periodEndTime\n          priceMin\n          priceMax\n          productCatIds\n          ratingStar\n          priceDiscountRate\n          shopType\n          sellerCommissionRate\n          shopeeCommissionRate\n        }\n        pageInfo {\n          page\n          limit\n          hasNextPage\n          scrollId\n        }\n      }\n    }\n  `,\n  variables: {} // N√£o precisa mexer, mas pode usar vari√°veis tamb√©m\n};\n\nconst payloadString = JSON.stringify(graphqlPayloadObject);\nconst timestamp = Math.floor(Date.now() / 1000);\nconst signatureFactor = `${appId}${timestamp}${payloadString}${secret}`;\nconst signature = crypto.createHash('sha256').update(signatureFactor).digest('hex');\nconst authorizationHeader = `SHA256 Credential=${appId}, Timestamp=${timestamp}, Signature=${signature}`;\n\n// Retorno correto pra n8n:\nreturn [{\n  json: {\n    authorizationHeader: authorizationHeader,\n    requestBody: graphqlPayloadObject\n  }\n}];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[352,1632],"id":"ceff518c-6319-4084-9c81-9a172e6f8c33","name":"Prepara Query para API Shopee2"},{"parameters":{"jsCode":"// n8n: cada execu√ß√£o recebe UM item por vez\nconst prod = $json;\n\nfunction formatFaixaPreco(pminRaw, pmaxRaw) {\n  const toNum = v => Number(String(v ?? '').replace(',', '.'));\n  const pmin = toNum(pminRaw);\n  const pmax = toNum(pmaxRaw);\n  const fmt = v => isFinite(v) ? ('R$ ' + v.toFixed(2).replace('.', ',')) : null;\n\n  if (!isFinite(pmin) && !isFinite(pmax)) return 'Indispon√≠vel';\n  if (isFinite(pmin) && isFinite(pmax)) {\n    if (Math.abs(pmax - pmin) < 0.01) return fmt(pmin);\n    const spread = (pmax - pmin) / Math.max(pmin, 0.01);\n    return spread >= 0.2 ? ('a partir de ' + fmt(pmin)) : ('de ' + fmt(pmin) + ' a ' + fmt(pmax));\n  }\n  if (isFinite(pmin)) return 'a partir de ' + fmt(pmin);\n  if (isFinite(pmax)) return 'at√© ' + fmt(pmax);\n  return 'Indispon√≠vel';\n}\n\nreturn [\n  {\n    json: {\n      nome: prod.productName,\n      id: prod.itemId,\n      loja: prod.shopName,\n      preco: Number(prod.price),\n      comissao: Number(prod.commission),\n      percentualComissao: Number(prod.percentCommission),\n      vendas: prod.sales,\n      avaliacao: prod.ratingStar,\n      imagem: prod.imageUrl,\n      linkProduto: prod.productLink,\n      linkAfiliado: prod.offerLink,\n      categorias: prod.productCatIds,\n      faixaPrecoFormatada: formatFaixaPreco(prod.priceMin, prod.priceMax)\n    }\n  }\n];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[1024,1632],"id":"4792ecf5-a026-4a4e-8c9d-ae398beeaa11","name":"Extrai Informa√ß√µes2"},{"parameters":{"assignments":{"assignments":[{"id":"2e2a3ebf-2538-4960-b2ae-c7d7825abe32","name":"VIP_000_Lootbox_Legends_numero","value":"120363403802905664@g.us","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-96,2128],"id":"da50f008-468b-41c5-8c8f-695e97f48051","name":"VIP 000 - Lootbox Legends - Numero1"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":1996874015,"mode":"list","cachedResultName":"VIP 000 - Lootbox Legends","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=1996874015"},"columns":{"mappingMode":"defineBelow","value":{"ID do produto":"={{ $json['ID Produto'] }}"},"matchingColumns":["ID do produto"],"schema":[{"id":"ID do produto","displayName":"ID do produto","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[176,2640],"id":"57bb7cfa-2a10-476d-bf03-f3ee06cc5439","name":"Adiciona produto na planilha1","credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":1996874015,"mode":"list","cachedResultName":"VIP 000 - Lootbox Legends","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=1996874015"},"filtersUI":{"values":[{"lookupColumn":"ID do produto","lookupValue":"={{ $json.id }}"}]},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[1248,1632],"id":"304795f2-1c7c-4408-8af6-9ed16d1d257d","name":"Pesquisa produto1","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"46494b7d-471c-47c3-b0dd-50f47f687053","leftValue":"={{ $json.row_number }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[1504,1632],"id":"390d271d-868c-4b77-bbe1-dfa94411712b","name":"se retornou algo1"},{"parameters":{"options":{}},"type":"@n8n/n8n-nodes-langchain.lmChatGroq","typeVersion":1,"position":[576,2240],"id":"526a037b-9b81-43a7-ae63-fc288848b98f","name":"Groq Chat Model4","credentials":{"groqApi":{"id":"goykBSqf3Way2XVY","name":"Groq account"}}},{"parameters":{"assignments":{"assignments":[{"id":"7414a362-692e-40ee-9bfb-a2a021bc4ead","name":"keyword","value":"={{ (() => {   const min = Number($json[\"Minute\"]);   if (min === 0) return \"Celulares e Dispositivos\";   if (min === 15) return \"Computadores e Acess√≥rios\";   if (min === 30) return \"Celulares e Dispositivos\";   if (min === 45) return \"Casa e Constru√ß√£o\";   return \"Indefinido\"; })() }}","type":"string"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[112,1632],"id":"b21a64b5-75aa-4b95-a438-759bd2d94b10","name":"Edit Fields3"},{"parameters":{"jsCode":"// Acesse todos os items do input\nconst items = $input.all(); // array, cada item tem .json\n\nconst results = [];\n\nfor (const item of items) {\n  // Caminho at√© produtos na resposta\n  const nodes = item.json?.data?.productOfferV2?.nodes || [];\n  for (const product of nodes) {\n    // Converta para numero\n    const commission = parseFloat(product.commission);\n    const price = parseFloat(product.price);\n\n    // Verifica se price √© maior que zero para evitar divis√£o por zero\n    if (price > 0 && commission > 0) {\n      const percent = (commission / price) * 100;\n      // Passa s√≥ se for maior que 40%\n      if (percent > 40) {\n        results.push({ json: { ...product, percentCommission: percent } });\n      }\n    }\n  }\n}\n\nreturn results;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[784,1632],"id":"4aa3b843-be1b-4ab2-b748-e5d378b3adb4","name":"Code2"},{"parameters":{"method":"POST","url":"=https://open-api.affiliate.shopee.com.br/graphql","sendHeaders":true,"headerParameters":{"parameters":[{"name":"Content-Type","value":"application/json"},{"name":"Authorization","value":"={{ $json.authorizationHeader }}"}]},"sendBody":true,"specifyBody":"json","jsonBody":"={{ $json.requestBody }}","options":{}},"type":"n8n-nodes-base.httpRequest","typeVersion":4.2,"position":[3984,480],"id":"0c167a2b-68e4-437c-821b-7cd30e457276","name":"API Shopee3"},{"parameters":{"jsCode":"const crypto = require('crypto');\n\n// --- Suas credenciais da Shopee ---\nconst appId = '18398850421';\nconst secret = 'Q24H7XRYJKETZ7FTTSCL3GL7XLKFV5VV';\n\n// --- IDs do produto que voc√™ quer consultar (usaremos para filtrar DEPOIS da requisi√ß√£o) ---\n\n\n// --- 1. Definir o Payload da Requisi√ß√£o GraphQL (SEM ARGUMENTOS DE FILTRO) ---\nconst graphqlPayloadObject = {\n  query: `\n    query GetProductOffers {\n      productOfferV2 { // <--- Chamando sem argumentos\n        nodes {\n          productName\n          itemId\n          shopId\n          commissionRate\n          commission\n          price\n          sales\n          imageUrl\n          shopName\n          productLink\n          offerLink\n          periodStartTime\n          periodEndTime\n          priceMin\n          priceMax\n          productCatIds\n          ratingStar\n          priceDiscountRate\n          shopType\n          sellerCommissionRate\n          shopeeCommissionRate\n        }\n        pageInfo {\n          page\n          limit\n          hasNextPage\n          scrollId\n        }\n      }\n    }\n  `,\n  variables: {} // Objeto de vari√°veis vazio, pois n√£o estamos passando argumentos\n};\n\n// O payload para a assinatura deve ser a string JSON exata que ser√° enviada.\nconst payloadString = JSON.stringify(graphqlPayloadObject);\n\n// --- 2. Obter o Timestamp Atual ---\nconst timestamp = Math.floor(Date.now() / 1000);\n\n// --- 3. Construir o Fator de Assinatura ---\nconst signatureFactor = `${appId}${timestamp}${payloadString}${secret}`;\n\n// --- 4. Calcular a Assinatura SHA256 ---\nconst signature = crypto.createHash('sha256').update(signatureFactor).digest('hex');\n\n// --- 5. Gerar o Cabe√ßalho de Autoriza√ß√£o ---\nconst authorizationHeader = `SHA256 Credential=${appId}, Timestamp=${timestamp}, Signature=${signature}`;\n\n// Retornar os dados necess√°rios para o pr√≥ximo n√≥ (HTTP Request)\nreturn [{\n  json: {\n    authorizationHeader: authorizationHeader,\n    requestBody: graphqlPayloadObject\n  }\n}];"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[3776,480],"id":"dcf33ec9-a7ed-4e2e-ae2e-7c92880a050c","name":"Prepara Query para API Shopee3"},{"parameters":{"jsCode":"const prod = $json;\n\nfunction formatFaixaPreco(pminRaw, pmaxRaw) {\n  const toNum = v => Number(String(v ?? '').replace(',', '.'));\n  const pmin = toNum(pminRaw);\n  const pmax = toNum(pmaxRaw);\n  const fmt = v => isFinite(v) ? ('R$ ' + v.toFixed(2).replace('.', ',')) : null;\n  if (!isFinite(pmin) && !isFinite(pmax)) return 'Indispon√≠vel';\n  if (isFinite(pmin) && isFinite(pmax)) {\n    if (Math.abs(pmax - pmin) < 0.01) return fmt(pmin);\n    const spread = (pmax - pmin) / Math.max(pmin, 0.01);\n    return spread >= 0.2 ? ('a partir de ' + fmt(pmin)) : ('de ' + fmt(pmin) + ' a ' + fmt(pmax));\n  }\n  if (isFinite(pmin)) return 'a partir de ' + fmt(pmin);\n  if (isFinite(pmax)) return 'at√© ' + fmt(pmax);\n  return 'Indispon√≠vel';\n}\n\nreturn [\n  {\n    json: {\n      nome: prod.productName,\n      id: prod.itemId,\n      loja: prod.shopName,\n      vendas: Number(prod.sales),\n      avaliacao: prod.ratingStar,\n      comissao: Number(prod.commission),\n      comissaoPercent: Number(prod.commissionRate) * 100,\n      preco: Number(prod.price),\n      faixaPreco: formatFaixaPreco(prod.priceMin, prod.priceMax),\n      desconto: prod.priceDiscountRate,\n      imagem: prod.imageUrl,\n      link: prod.productLink,\n      linkAfiliado: prod.offerLink,\n      categorias: prod.productCatIds\n    }\n  }\n];\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4672,496],"id":"aeba1a49-829d-4f67-bb4a-5cadc44873ff","name":"Extrai Informa√ß√µes3"},{"parameters":{"jsCode":"const items = $input.all();\nconst resultados = [];\n\n// Percorre todos os items do input\nfor (const item of items) {\n  const nodes = item.json?.data?.productOfferV2?.nodes || [];\n  for (const prod of nodes) {\n    if (Number(prod.sales) > 5000) {\n      resultados.push({ json: prod });\n    }\n  }\n}\n\nreturn resultados;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[4192,480],"id":"1281e167-eb62-48fc-810d-61401bb59097","name":"Code3"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[4400,480],"id":"a8d962de-9269-4782-9dd5-85c7a2ab05e4","name":"Loop Over Items3"},{"parameters":{"operation":"append","documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Produtos shopee","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=0"},"columns":{"mappingMode":"defineBelow","value":{"Status":"nao_enviado","ID":"={{ $('Extrai Informa√ß√µes3').item.json.id }}","Item Name":"={{ $('Extrai Informa√ß√µes3').item.json.nome }}","Price":"={{ $('Extrai Informa√ß√µes3').item.json.preco }}","Sales":"={{ $('Extrai Informa√ß√µes3').item.json.vendas }}","Shop Name":"={{ $('Extrai Informa√ß√µes3').item.json.loja }}","Commission Rate":"={{ $('Extrai Informa√ß√µes3').item.json.comissaoPercent }}","Commission":"={{ $('Extrai Informa√ß√µes3').item.json.comissao }}","Product Link":"={{ $('Extrai Informa√ß√µes3').item.json.link }}","Offer Link":"={{ $('Extrai Informa√ß√µes3').item.json.linkAfiliado }}"},"matchingColumns":[],"schema":[{"id":"Status","displayName":"Status","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"ID","displayName":"ID","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Item Name","displayName":"Item Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Price","displayName":"Price","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Sales","displayName":"Sales","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Shop Name","displayName":"Shop Name","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Commission Rate","displayName":"Commission Rate","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Commission","displayName":"Commission","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Product Link","displayName":"Product Link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Offer Link","displayName":"Offer Link","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true},{"id":"Finalizado em","displayName":"Finalizado em","required":false,"defaultMatch":false,"display":true,"type":"string","canBeUsedToMatch":true,"removed":true}],"attemptToConvertTypes":false,"convertFieldsToString":false},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.6,"position":[5360,512],"id":"4991ac53-b52c-48a3-9987-d38fdead4ff4","name":"Adiciona produto na planilha2","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Produtos shopee","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"ID","lookupValue":"={{ $json.id }}"}]},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[4880,496],"id":"95378fe1-9e7e-4813-b56a-338a15fb8d4f","name":"Get row(s) in sheet","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"ca6a2dd3-bb03-4c47-b07c-bb3224f3bd6b","leftValue":"={{ $json.row_number }}","rightValue":"","operator":{"type":"number","operation":"exists","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[5088,496],"id":"c5dcb0a0-3351-40f5-ad5c-d962b5ed7f80","name":"If"},{"parameters":{"content":"","height":416,"width":2128,"color":5},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[3712,336],"id":"8d51fc16-8fdf-4d6c-a754-a4ecd612fde1","name":"Sticky Note24"},{"parameters":{"content":"# Alimenta lista de produtos shopee","height":96,"width":608,"color":3},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[3712,336],"id":"8c3601ec-031d-4346-834b-6bd247287e5d","name":"Sticky Note25"},{"parameters":{"documentId":{"__rl":true,"value":"1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY","mode":"id"},"sheetName":{"__rl":true,"value":"gid=0","mode":"list","cachedResultName":"Produtos shopee","cachedResultUrl":"https://docs.google.com/spreadsheets/d/1qQJE9M5xGDcspFJAatzshol2_rhqemG7audaNt2SAVY/edit#gid=0"},"filtersUI":{"values":[{"lookupColumn":"Status","lookupValue":"nao_enviado"}]},"options":{}},"type":"n8n-nodes-base.googleSheets","typeVersion":4.7,"position":[4528,48],"id":"57230659-026f-4802-80c1-af1e8c8833f6","name":"Get row(s) in sheet1","alwaysOutputData":true,"credentials":{"googleSheetsOAuth2Api":{"id":"wvCtRhdolqHS01D3","name":"Google Sheets account"}}},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"659049be-e916-4801-a50a-de412742ff37","leftValue":"={{ $items().length }}","rightValue":3,"operator":{"type":"number","operation":"gt"}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[4736,48],"id":"b34ba0d5-62c9-4884-8c95-b08768b359da","name":"If1"},{"parameters":{},"type":"n8n-nodes-base.noOp","typeVersion":1,"position":[4944,32],"id":"9125caf7-22ef-4d4e-8b39-1a3524bc51b1","name":"No Operation, do nothing"},{"parameters":{"rule":{"interval":[{"triggerAtHour":7}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[3792,48],"id":"18f70f03-fd78-4375-83d0-74476ee623bd","name":"Schedule Trigger6","disabled":true},{"parameters":{"rule":{"interval":[{"triggerAtHour":15}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[4256,48],"id":"6068944e-f1a0-45a4-91d2-341495eab5f1","name":"Schedule Trigger7","disabled":true},{"parameters":{"rule":{"interval":[{"triggerAtHour":11}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[4000,48],"id":"1c0f898e-9a5c-43eb-90cf-bff336491953","name":"Schedule Trigger8","disabled":true},{"parameters":{"content":"","height":368,"width":1776},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[3712,-64],"id":"dbe11d94-cfc7-4ccc-8852-deaabfbd1df5","name":"Sticky Note26"},{"parameters":{"content":"# Verifica se j√° tem o suficiente na planilha","height":80,"width":688,"color":6},"type":"n8n-nodes-base.stickyNote","typeVersion":1,"position":[3712,-64],"id":"e5873215-dc43-4b12-b137-9bbc2257c892","name":"Sticky Note27"}],"connections":{"OpenAI Chat Model":{"ai_languageModel":[[]]},"AI Agent":{"main":[[{"node":"Wait","type":"main","index":0}]]},"Wait":{"main":[[{"node":"Enviar imagem","type":"main","index":0}]]},"Enviar imagem":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Loop Over Items1":{"main":[[{"node":"Edit Fields","type":"main","index":0}],[{"node":"AI Agent","type":"main","index":0}]]},"Edit Fields":{"main":[[{"node":"Adiciona produto na planilha","type":"main","index":0}]]},"Schedule Trigger":{"main":[[{"node":"Prepara Query para API Shopee","type":"main","index":0}]]},"Error Trigger":{"main":[[{"node":"AI Agent1","type":"main","index":0}]]},"AI Agent1":{"main":[[{"node":"Code","type":"main","index":0}]]},"Code":{"main":[[{"node":"Create a card","type":"main","index":0}]]},"Pesquisa imagem":{"main":[[{"node":"Extrair imagem do link","type":"main","index":0}]]},"Extrair imagem do link":{"main":[[{"node":"VIP 000 - Lootbox Legends - Numero","type":"main","index":0}]]},"API Shopee":{"main":[[{"node":"Extrai Informa√ß√µes","type":"main","index":0}]]},"Prepara Query para API Shopee":{"main":[[{"node":"API Shopee","type":"main","index":0}]]},"Extrai Informa√ß√µes":{"main":[[{"node":"Pesquisa produto","type":"main","index":0}]]},"VIP 000 - Lootbox Legends - Numero":{"main":[[{"node":"Loop Over Items1","type":"main","index":0}]]},"Pesquisa produto":{"main":[[{"node":"se retornou algo","type":"main","index":0}]]},"se retornou algo":{"main":[[{"node":"Prepara Query para API Shopee","type":"main","index":0}],[{"node":"Pesquisa imagem","type":"main","index":0}]]},"Groq Chat Model":{"ai_languageModel":[[{"node":"AI Agent","type":"ai_languageModel","index":0}]]},"Pega produto na planilha":{"main":[[{"node":"Prepara Query para API Shopee1","type":"main","index":0}]]},"Pega 'telefone' dos grupos":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Schedule Trigger3":{"main":[[{"node":"Pega produto na planilha","type":"main","index":0}]]},"Schedule Trigger4":{"main":[[{"node":"Pega produto na planilha","type":"main","index":0}]]},"AI Agent2":{"main":[[{"node":"Wait1","type":"main","index":0}]]},"Enviar imagem1":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Wait1":{"main":[[{"node":"Enviar imagem1","type":"main","index":0}]]},"Loop Over Items":{"main":[[{"node":"Edit Fields1","type":"main","index":0}],[{"node":"AI Agent2","type":"main","index":0}]]},"Edit Fields1":{"main":[[{"node":"Pega produto na planilha1","type":"main","index":0}]]},"AI Agent3":{"main":[[{"node":"Code1","type":"main","index":0}]]},"OpenAI Chat Model3":{"ai_languageModel":[[]]},"Code1":{"main":[[{"node":"Create a card1","type":"main","index":0}]]},"Pesquisa imagem1":{"main":[[{"node":"Extrair imagem do link1","type":"main","index":0}]]},"Extrair imagem do link1":{"main":[[{"node":"Pega 'telefone' dos grupos","type":"main","index":0}]]},"API Shopee1":{"main":[[{"node":"Extrai Informa√ß√µes1","type":"main","index":0}]]},"Prepara Query para API Shopee1":{"main":[[{"node":"API Shopee1","type":"main","index":0}]]},"Extrai Informa√ß√µes1":{"main":[[{"node":"Pesquisa imagem1","type":"main","index":0}]]},"Schedule Trigger1":{"main":[[{"node":"Pega produto na planilha","type":"main","index":0}]]},"Groq Chat Model1":{"ai_languageModel":[[{"node":"AI Agent2","type":"ai_languageModel","index":0}]]},"OpenAI Chat Model1":{"ai_languageModel":[[]]},"Groq Chat Model2":{"ai_languageModel":[[{"node":"AI Agent1","type":"ai_languageModel","index":0}]]},"Groq Chat Model3":{"ai_languageModel":[[{"node":"AI Agent3","type":"ai_languageModel","index":0}]]},"AI Agent4":{"main":[[{"node":"Wait2","type":"main","index":0}]]},"Enviar imagem2":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"Wait2":{"main":[[{"node":"Enviar imagem2","type":"main","index":0}]]},"Loop Over Items2":{"main":[[{"node":"Edit Fields2","type":"main","index":0}],[{"node":"AI Agent4","type":"main","index":0}]]},"Edit Fields2":{"main":[[{"node":"Adiciona produto na planilha1","type":"main","index":0}]]},"Schedule Trigger2":{"main":[[{"node":"Edit Fields3","type":"main","index":0}]]},"Pesquisa imagem2":{"main":[[{"node":"Extrair imagem do link2","type":"main","index":0}]]},"Extrair imagem do link2":{"main":[[{"node":"VIP 000 - Lootbox Legends - Numero1","type":"main","index":0}]]},"API Shopee2":{"main":[[{"node":"Code2","type":"main","index":0}]]},"Prepara Query para API Shopee2":{"main":[[{"node":"API Shopee2","type":"main","index":0}]]},"Extrai Informa√ß√µes2":{"main":[[{"node":"Pesquisa produto1","type":"main","index":0}]]},"VIP 000 - Lootbox Legends - Numero1":{"main":[[{"node":"Loop Over Items2","type":"main","index":0}]]},"Pesquisa produto1":{"main":[[{"node":"se retornou algo1","type":"main","index":0}]]},"se retornou algo1":{"main":[[{"node":"Prepara Query para API Shopee2","type":"main","index":0}],[{"node":"Pesquisa imagem2","type":"main","index":0}]]},"Groq Chat Model4":{"ai_languageModel":[[{"node":"AI Agent4","type":"ai_languageModel","index":0}]]},"Edit Fields3":{"main":[[{"node":"Prepara Query para API Shopee2","type":"main","index":0}]]},"Code2":{"main":[[{"node":"Extrai Informa√ß√µes2","type":"main","index":0}]]},"API Shopee3":{"main":[[{"node":"Code3","type":"main","index":0}]]},"Prepara Query para API Shopee3":{"main":[[{"node":"API Shopee3","type":"main","index":0}]]},"Extrai Informa√ß√µes3":{"main":[[{"node":"Get row(s) in sheet","type":"main","index":0}]]},"Code3":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Loop Over Items3":{"main":[[],[{"node":"Extrai Informa√ß√µes3","type":"main","index":0}]]},"Adiciona produto na planilha2":{"main":[[{"node":"Loop Over Items3","type":"main","index":0}]]},"Get row(s) in sheet":{"main":[[{"node":"If","type":"main","index":0}]]},"If":{"main":[[],[{"node":"Adiciona produto na planilha2","type":"main","index":0}]]},"Get row(s) in sheet1":{"main":[[{"node":"If1","type":"main","index":0}]]},"If1":{"main":[[{"node":"No Operation, do nothing","type":"main","index":0}],[{"node":"Prepara Query para API Shopee3","type":"main","index":0}]]},"Schedule Trigger6":{"main":[[{"node":"Get row(s) in sheet1","type":"main","index":0}]]},"Schedule Trigger8":{"main":[[{"node":"Get row(s) in sheet1","type":"main","index":0}]]},"Schedule Trigger7":{"main":[[{"node":"Get row(s) in sheet1","type":"main","index":0}]]}},"pinData":{"Schedule Trigger3":[{"json":{"timestamp":"2025-08-20T08:00:06.006-03:00","Readable date":"August 20th 2025, 8:00:06 am","Readable time":"8:00:06 am","Day of week":"Wednesday","Year":"2025","Month":"August","Day of month":"20","Hour":"08","Minute":"00","Second":"06","Timezone":"America/Sao_Paulo (UTC-03:00)"}}],"Schedule Trigger2":[{"json":{"timestamp":"2025-08-22T22:15:00.005-03:00","Readable date":"August 22nd 2025, 10:15:00 pm","Readable time":"10:15:00 pm","Day of week":"Friday","Year":"2025","Month":"August","Day of month":"22","Hour":"22","Minute":"15","Second":"00","Timezone":"America/Sao_Paulo (UTC-03:00)"}}]},"meta":{"templateCredsSetupCompleted":true}}